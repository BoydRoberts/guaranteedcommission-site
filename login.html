<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login / Create Account | GuaranteedCommission.com</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .badge { font-size:11px; background:#f3f4f6; color:#4b5563; padding:.1rem .5rem; border-radius:.375rem; }
  </style>
</head>
<body class="bg-gray-100 text-gray-900">

  <!-- Header (original copy) -->
  <header class="bg-white shadow">
    <div class="flex justify-between items-center max-w-7xl mx-auto px-4 py-4">
      <a href="/index.html" class="text-xs text-blue-600 hover:underline">&larr; Home</a>
      <div class="text-center">
        <h1 class="text-2xl font-bold">GuaranteedCommission.com</h1>
        <p class="text-xs text-gray-600">
          Guaranteeing commissions so your home will sell quickly at a higher price.
        </p>
      </div>
      <span></span>
    </div>
  </header>

  <main class="min-h-[calc(100vh-80px)] flex items-start justify-center px-4 py-8">
    <div class="w-full max-w-md bg-white rounded-2xl shadow p-6 relative">
      <div class="text-center mb-3">
        <span class="badge">secure access build 2025-08-14b</span>
      </div>

      <!-- Tabs -->
      <div class="flex border-b mb-4" role="tablist" aria-label="Auth Tabs">
        <button type="button" id="tab-signin"
          class="flex-1 py-2 text-center font-semibold border-b-2 border-blue-600 text-blue-700"
          aria-selected="true" aria-controls="panel-signin">
          Sign In
        </button>
        <button type="button" id="tab-create"
          class="flex-1 py-2 text-center font-semibold border-b-2 border-transparent text-gray-500 hover:text-gray-700"
          aria-selected="false" aria-controls="panel-create">
          Create Account
        </button>
      </div>

      <!-- Status -->
      <div id="status" class="hidden mb-4 text-sm rounded-lg p-3" role="alert"></div>

      <!-- SIGN IN -->
      <form id="loginForm" class="space-y-4" autocomplete="off" aria-labelledby="tab-signin">
        <div>
          <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
          <input id="email" name="email" type="email" required
                 class="mt-1 w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                 placeholder="you@example.com" />
        </div>

        <div>
          <label for="password" class="block text-sm font-medium text-gray-700">Password</label>
          <div class="relative mt-1">
            <input id="password" name="password" type="password" required
                   class="w-full border rounded-lg px-3 py-2 pr-12 focus:outline-none focus:ring-2 focus:ring-blue-500"
                   placeholder="Your password" />
            <button type="button" id="togglePwd"
                    class="absolute inset-y-0 right-0 px-3 text-sm text-blue-600 hover:underline select-none">
              Show
            </button>
          </div>
        </div>

        <div class="flex items-center justify-between text-sm">
          <a href="/forgot-password.html" class="text-blue-600 hover:underline">Forgot password?</a>
          <a href="#" id="goCreate" class="text-blue-600 hover:underline">Create account</a>
        </div>

        <button type="submit"
                class="w-full bg-blue-600 text-white py-2 rounded-lg font-semibold hover:bg-blue-700 transition">
          Log In
        </button>
      </form>

      <!-- CREATE ACCOUNT -->
      <form id="createForm" class="space-y-4 hidden" autocomplete="off" aria-labelledby="tab-create">
        <div>
          <label for="c_name" class="block text-sm font-medium text-gray-700">Full Name</label>
          <input id="c_name" type="text" required
                 class="mt-1 w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                 placeholder="First Last" />
        </div>

        <div>
          <label for="c_email" class="block text-sm font-medium text-gray-700">Email</label>
          <input id="c_email" type="email" required
                 class="mt-1 w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                 placeholder="you@example.com" />
        </div>

        <div>
          <label for="c_phone" class="block text-sm font-medium text-gray-700">Phone</label>
          <input id="c_phone" type="tel" required
                 class="mt-1 w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                 placeholder="123-456-7890" inputmode="numeric" />
          <p class="text-xs text-gray-500 mt-1">Format: 123-456-7890</p>
        </div>

        <div>
          <label for="c_password" class="block text-sm font-medium text-gray-700">Create Password</label>
          <div class="relative mt-1">
            <input id="c_password" type="password" required
                   class="w-full border rounded-lg px-3 py-2 pr-12 focus:outline-none focus:ring-2 focus:ring-blue-500"
                   placeholder="At least 10 characters, letters, numbers, symbol" />
            <button type="button" id="togglePwdC1"
                    class="absolute inset-y-0 right-0 px-3 text-sm text-blue-600 hover:underline select-none">
              Show
            </button>
          </div>

          <!-- Strength -->
          <div class="mt-2">
            <div class="h-2 w-full bg-gray-200 rounded" aria-hidden="true">
              <div id="strengthBar" class="h-2 w-0 rounded"></div>
            </div>
            <p id="strengthText" class="text-xs mt-1 text-gray-600">Password strength: â€”</p>
            <ul class="text-[11px] text-gray-600 mt-2 list-disc list-inside">
              <li>At least 10 characters</li>
              <li>Include UPPER &amp; lower case letters</li>
              <li>Include a number and a symbol</li>
            </ul>
          </div>
        </div>

        <div>
          <label for="c_password2" class="block text-sm font-medium text-gray-700">Confirm Password</label>
          <div class="relative mt-1">
            <input id="c_password2" type="password" required
                   class="w-full border rounded-lg px-3 py-2 pr-12 focus:outline-none focus:ring-2 focus:ring-blue-500"
                   placeholder="Re-type your password" />
            <button type="button" id="togglePwdC2"
                    class="absolute inset-y-0 right-0 px-3 text-sm text-blue-600 hover:underline select-none">
              Show
            </button>
          </div>
          <p id="matchMsg" class="text-xs mt-1"></p>
        </div>

        <div class="flex items-center justify-between text-sm">
          <a href="#" id="goSignin" class="text-blue-600 hover:underline">Already have an account? Sign in</a>
        </div>

        <button type="submit"
                class="w-full bg-green-600 text-white py-2 rounded-lg font-semibold hover:bg-green-700 transition">
          Create Account
        </button>
      </form>

      <p class="text-[11px] text-gray-500 text-center mt-4">
        We never sell your data. Used only for escrow &amp; identification.
      </p>

      <!-- Debug toggle -->
      <button id="dbgToggle" class="absolute top-2 right-2 text-[11px] px-2 py-1 rounded border">Debug</button>
      <pre id="dbgPanel" class="hidden mt-2 text-[11px] bg-gray-50 border rounded p-2 whitespace-pre-wrap break-all"></pre>
    </div>
  </main>

  <script>
    console.log('[login] secure access build 2025-08-14b');

    const $ = (id) => document.getElementById(id);
    const safeJSON = (s)=>{ try { return JSON.parse(s); } catch { return null; } };

    // Prefill from Box 2
    (function prefill() {
      const fd = safeJSON(localStorage.getItem('formData')) || {};
      const plan = (localStorage.getItem('selectedPlan') || 'Listed Property Basic').trim();

      if (fd.name) $('c_name').value = fd.name;

      // --- Clear agentEmail in Listed flows (safety step) ---
      if (!plan.includes('FSBO') && fd.agentEmail) {
        fd.agentEmail = "";
        localStorage.setItem('formData', JSON.stringify(fd));
      }

      // Email prefill
      let emailToUse = '';
      if (plan.includes('FSBO')) {
        emailToUse = fd.fsboEmail || '';
      } else {
        const candidate = localStorage.getItem('loggedInEmail') || '';
        if (candidate && candidate !== (fd.agentEmail || '')) {
          emailToUse = candidate;
        }
      }
      if (emailToUse) {
        $('email').value = emailToUse;
        $('c_email').value = emailToUse;
      }

      // Phone (FSBO only)
      if (plan.includes('FSBO') && (fd.phone || fd.agentPhone)) {
        $('c_phone').value = (fd.phone || fd.agentPhone);
      }
    })();
  </script>
</body>
</html>
