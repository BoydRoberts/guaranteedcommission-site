<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GuaranteedCommission.com</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .font-cursive { font-family: 'Brush Script MT', cursive; }
    .group:hover #commissionMenu,
    .group:focus-within #commissionMenu { display: block; }
    #commissionMenu { display: none; }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">

<!-- Header -->
<header class="bg-white shadow">
  <div class="flex justify-between items-center max-w-7xl mx-auto px-4 py-4">
    <button onclick="openInvestorModal()" class="bg-red-600 text-white text-xs font-semibold px-3 py-1 rounded">
      Accredited Investors Only
    </button>
    <div class="text-center flex-1">
      <h1 class="text-3xl font-bold">GuaranteedCommission.com</h1>
      <p class="text-sm text-red-600 mt-1 px-2">
        Guaranteeing buyer agent’s commissions so your home will sell quickly at a higher price.
      </p>
    </div>
    <button onclick="openPressModal()" class="bg-blue-600 text-white text-xs font-semibold px-3 py-1 rounded">
      Press Inquiry
    </button>
  </div>
</header>

<!-- Investor Modal -->
<div id="investorModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
  <div class="bg-white rounded-lg shadow-lg p-6 w-96 relative">
    <button onclick="closeInvestorModal()" class="absolute top-2 right-2 text-xl font-bold">&times;</button>
    <h2 class="text-lg font-bold mb-4">Accredited Investor Certification</h2>
    <label class="block mb-2"><input type="checkbox"> Net worth exceeds $1M</label>
    <label class="block mb-2"><input type="checkbox"> Annual income exceeds $200K</label>
    <input type="text" id="investorName" placeholder="Full Name" class="w-full border p-1 mb-2 rounded">
    <input type="tel" id="investorPhone" placeholder="Phone Number" class="w-full border p-1 mb-2 rounded">
    <input type="email" id="investorEmail" placeholder="Email Address" class="w-full border p-1 mb-4 rounded">
    <button onclick="submitInvestorForm()" class="w-full bg-blue-600 text-white py-2 rounded">Submit</button>
    <p id="investorConfirmation" class="mt-4 text-green-600 font-semibold text-center hidden">We will be in touch.</p>
  </div>
</div>

<!-- Press Modal -->
<div id="pressModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
  <div class="bg-white rounded-lg shadow-lg p-6 w-96 relative">
    <button onclick="closePressModal()" class="absolute top-2 right-2 text-xl font-bold">&times;</button>
    <h2 class="text-lg font-bold mb-4">Press Inquiry Form</h2>
    <input type="text" id="pressName" placeholder="Full Name" class="w-full border p-1 mb-2 rounded">
    <input type="text" id="pressOrg" placeholder="Organization" class="w-full border p-1 mb-2 rounded">
    <input type="tel" id="pressPhone" placeholder="Phone Number" class="w-full border p-1 mb-2 rounded">
    <input type="email" id="pressEmail" placeholder="Email Address" class="w-full border p-1 mb-4 rounded">
    <button onclick="submitPressForm()" class="w-full bg-blue-600 text-white py-2 rounded">Submit</button>
    <p id="pressConfirmation" class="mt-4 text-green-600 font-semibold text-center hidden">We will be in touch.</p>
  </div>
</div>

<!-- Nav -->
<nav class="bg-gray-200 py-2">
  <ul class="flex justify-center space-x-8 font-semibold">
    <li class="relative group">
      <span class="hover:underline cursor-pointer">Communicate Guaranteed Commission</span>
      <ul id="commissionMenu" class="absolute left-0 mt-2 w-64 bg-white border shadow text-sm text-gray-700 z-10">
        <li><a href="#" onclick="showForm('listed')" class="block px-4 py-2 hover:bg-gray-100">Listed Property Basic</a></li>
        <li><a href="#" onclick="showForm('plus')" class="block px-4 py-2 hover:bg-gray-100">Listed Property Plus</a></li>
        <li><a href="#" onclick="showForm('fsbo')" class="block px-4 py-2 hover:bg-gray-100">FSBO Plus</a></li>
      </ul>
    </li>
    <li><a href="/search.html" class="hover:underline">Search Guaranteed Commission</a></li>
    <li><a href="/login.html" class="hover:underline">Log In</a></li>
  </ul>
</nav>

<!-- Strip 1 -->
<section class="flex flex-col md:flex-row justify-center items-start gap-6 px-4 py-8 max-w-7xl mx-auto">
  <!-- Box 1 -->
  <div class="w-full md:w-1/3 bg-white p-4 rounded shadow text-sm">
    <h2 class="text-lg font-bold mb-4 text-center">Commission Communication Menu</h2>
    <ul class="space-y-3">
      <li>
        <div onclick="selectPlan('Listed Property Basic')" class="cursor-pointer">
          <p class="text-base font-semibold">Listed Property Basic | <span class="text-red-600">FREE</span></p>
          <p class="text-gray-600 pl-5">Printable commission letter, map search, listing price, main photo, address, square footage, bedrooms, bathrooms, listing brokerage, listing agent, listing agent phone number.</p>
        </div>
      </li>
      <li>
        <div onclick="selectPlan('Listed Property Plus')" class="cursor-pointer">
          <p class="text-base font-semibold">Listed Property Plus | $20</p>
          <p class="text-gray-600 pl-5">Listed Property Basic plus 20 photos and full property description.</p>
        </div>
      </li>
      <li>
        <div onclick="selectPlan('FSBO Plus')" class="cursor-pointer">
          <p class="text-base font-semibold">FSBO Plus | $100</p>
          <p class="text-gray-600 pl-5">Listed Property Plus minus the listing agency. Includes showing instructions.</p>
        </div>
      </li>
    </ul>
  </div>

  <!-- Box 2 -->
  <div id="formBlock" class="w-full md:w-1/3 bg-white p-4 rounded shadow text-sm">
    <h2 class="text-lg font-bold mb-4 text-center">Listed Property Communication Form</h2>
    <form id="listingForm" class="space-y-2" autocomplete="off">
      <input type="text" id="name" placeholder="Name" class="w-full border p-1 rounded" required>
      <input type="text" id="address" placeholder="Address format: Street, City, ST 12345" class="w-full border p-1 rounded" required>
      <div class="flex gap-2">
        <input type="text" id="apn" placeholder="Parcel # / PIN # / Tax ID # / Folio # / APN #" class="w-full border p-1 rounded">
        <select id="apnPreset" class="border p-1 rounded text-sm w-36">
          <option value="">—</option>
          <option value="agent to provide">agent to provide</option>
        </select>
      </div>
      <div class="flex gap-2">
        <input type="text" id="commission" placeholder="Commission" class="w-full border p-1 rounded">
        <select id="commissionType" class="border p-1 rounded">
          <option value="%">%</option>
          <option value="$">$</option>
        </select>
      </div>
      <div class="relative">
        <input type="tel" id="agentPhone" placeholder="Agent’s direct phone only – NOT your number" class="w-full border p-1 rounded" required>
        <span id="phoneError" class="text-xs text-red-600 hidden">Please enter a valid phone number (123-456-7890)</span>
      </div>

      <!-- Agent Email (Listed/Plus only) -->
      <input type="email" id="agentEmail" placeholder="Listing Agent Email" class="w-full border p-1 rounded">

      <!-- Brokerage / email (switches based on type) -->
      <input type="text" id="brokerage" placeholder="Listing Brokerage" class="w-full border p-1 rounded">
      <input type="text" id="agent" placeholder="Listing Agent" class="w-full border p-1 rounded">

      <button type="button" onclick="submitForm()" class="w-full bg-green-600 text-white py-2 rounded mt-4">
        Submit Guaranteed Commission
      </button>
    </form>
  </div>

  <!-- Box 3 -->
  <div class="w-full md:w-1/3 bg-white p-4 rounded shadow text-sm">
    <h2 class="text-lg font-bold mb-2 text-center">Irrevocable Seller Communication</h2>

    <!-- LISTED ISC -->
    <div id="iscTextListed" class="">
      <p>To the escrow holder/closing agent,</p>
      <p class="mt-2">
        I, <span id="letterName">[name]</span>, am the owner/seller of
        <span id="letterAddressFull">[full address]</span><span id="apnChunk">, # <span id="letterAPN">[Parcel # / PIN # / Tax ID # / Folio # / APN #]</span></span>.
        <span id="letterAddressShort1">[short address]</span> is listed for sale by
        <span id="letterBrokerage">[listing brokerage]</span>,
        <span id="letterAgent">[listing agent]</span>, listing agent,
        <span id="letterAgentPhone">[agent phone]</span>.
      </p>
      <p class="mt-2">
        Let it be known: if a buyer’s agent/broker facilitates the sale of
        <span id="letterAddressShort2">[short address]</span>, you (the escrow holder/closing agent)
        are irrevocably instructed to credit/compensate the buyer’s broker – first, by debiting the
        listing brokerage (if there is an agreement for broker-to-broker compensation) and second by
        debiting me, the seller – a commission not to exceed
        <span id="letterCommissionDisplay">[commission]</span>
        <span id="commissionSuffix"></span>.
      </p>
      <p class="mt-4"><span id="signatureName" class="pl-5 font-cursive">[Name]</span> Electronic Signature      date</p>
    </div>

    <!-- FSBO ISC -->
    <div id="iscTextFSBO" class="hidden">
      <p>To the escrow holder/closing agent,</p>
      <p class="mt-2">
        I, <span id="letterNameFSBO">[name]</span>, am the owner/seller of
        <span id="letterAddressFullFSBO">[full address]</span>, #
        <span id="letterAPNFSBO">[Parcel # / PIN # / Tax ID # / Folio # / APN #]</span>.
        <span id="letterAddressShort1FSBO">[short address]</span> is listed for sale by owner (Me).
        My phone number is <span id="fsboPhone"></span>. My email address is <span id="fsboEmail"></span>.
      </p>
      <p class="mt-2">
        Let it be known: if a buyer’s agent/broker facilitates the sale of
        <span id="letterAddressShort2FSBO">[short address]</span>, you (the escrow holder/closing agent)
        are irrevocably instructed to credit/compensate the buyer’s broker a commission not to exceed
        <span id="letterCommissionDisplayFSBO">[commission]</span>
        <span id="commissionSuffixFSBO"></span>.
      </p>
      <p class="mt-4"><span id="signatureNameFSBO" class="pl-5 font-cursive">[Name]</span> Electronic Signature      date</p>
    </div>
  </div>
</section>

<!-- Scripts -->
<script>
  /* Header modals */
  function openInvestorModal(){ document.getElementById('investorModal').classList.remove('hidden'); }
  function closeInvestorModal(){ document.getElementById('investorModal').classList.add('hidden'); }
  function submitInvestorForm(){ document.getElementById('investorConfirmation').classList.remove('hidden'); }
  function openPressModal(){ document.getElementById('pressModal').classList.remove('hidden'); }
  function closePressModal(){ document.getElementById('pressModal').classList.add('hidden'); }
  function submitPressForm(){ document.getElementById('pressConfirmation').classList.remove('hidden'); }

  function $(id){ return document.getElementById(id); }

  /* Plan switcher */
  function selectPlan(planName){
    localStorage.setItem("selectedPlan", planName);
    showForm(planName === "FSBO Plus" ? "fsbo" : (planName === "Listed Property Plus" ? "plus" : "listed"));
  }

  /* Toggle which form text appears */
  function showForm(type){
    const title = document.querySelector("#formBlock h2");
    const phoneInput = $('agentPhone');
    const brokerageInput = $('brokerage');
    const agentInput = $('agent');
    const agentEmail = $('agentEmail');

    if(type === 'fsbo'){
      title.textContent = 'FSBO Communication Form';
      phoneInput.placeholder = 'Owner/Seller phone number';
      brokerageInput.placeholder = 'Owner/Seller email';
      agentInput.style.display = 'none';
      agentEmail.style.display = 'none';
      $('iscTextListed').classList.add('hidden');
      $('iscTextFSBO').classList.remove('hidden');
    } else {
      title.textContent = (type === 'plus' ? 'Listed Property Plus Communication Form' : 'Listed Property Communication Form');
      phoneInput.placeholder = 'Agent’s direct phone only – NOT your number';
      brokerageInput.placeholder = 'Listing Brokerage';
      agentInput.style.display = 'block';
      agentEmail.style.display = 'block';
      $('iscTextListed').classList.remove('hidden');
      $('iscTextFSBO').classList.add('hidden');
    }
  }

  // On load: set default form (Listed)
  window.addEventListener('DOMContentLoaded', () => {
    const selectedPlan = localStorage.getItem('selectedPlan') || 'Listed Property Basic';
    if(selectedPlan === 'FSBO Plus') showForm('fsbo');
    else if(selectedPlan === 'Listed Property Plus') showForm('plus');
    else showForm('listed');

    // APN preset helper
    $('apnPreset').addEventListener('change', ()=>{
      const v = $('apnPreset').value;
      if (v) $('apn').value = v;
      syncAll();
    });

    // Phone mask/validation
    const phoneInput = $('agentPhone');
    const phoneError = $('phoneError');
    phoneInput.addEventListener('input', function(){
      let v = this.value.replace(/\D/g,'');
      if(v.length>3 && v.length<=6) v = v.replace(/(\d{3})(\d+)/,'$1-$2');
      else if(v.length>6) v = v.replace(/(\d{3})(\d{3})(\d+)/,'$1-$2-$3');
      this.value = v;
      const ok = /^\d{3}-\d{3}-\d{4}$/.test(this.value);
      phoneInput.classList.toggle('border-red-500', !ok);
      phoneError.classList.toggle('hidden', ok);
    });

    // Live-bind fields to ISC (both variants)
    ['name','address','apn','brokerage','agent','agentPhone','commission','agentEmail'].forEach(id=>{
      const el = $(id);
      if(!el) return;
      el.addEventListener('input', syncAll);
    });

    $('commissionType').addEventListener('change', syncAll);

    function syncAll(){
      const fullAddr = ($('address').value || '').trim();
      const short = fullAddr.split(',')[0] || '';
      const nameVal = $('name').value || '';
      const apnVal = $('apn').value || '';
      const phoneVal = $('agentPhone').value || '';
      const brokerageVal = $('brokerage').value || '';
      const agentVal = $('agent').value || '';

      // Commission display
      const amount = ($('commission').value || '').trim();
      const type = $('commissionType').value;
      const suffix = type === '%' ? 'of the total purchase price' : '';
      const display = type === '$' ? ('$' + amount) : (amount ? amount + '%' : '');

      // For Listed: show or hide “, # APN” chunk
      $('apnChunk').style.display = apnVal ? 'inline' : 'none';

      // Listed bindings
      $('letterName').textContent = nameVal || '[name]';
      $('letterAddressFull').textContent = fullAddr || '[full address]';
      $('letterAddressShort1').textContent = short || '[short address]';
      $('letterAddressShort2').textContent = short || '[short address]';
      $('letterAPN').textContent = apnVal || '[Parcel # / PIN # / Tax ID # / Folio # / APN #]';
      $('letterBrokerage').textContent = brokerageVal || '[listing brokerage]';
      $('letterAgent').textContent = agentVal || '[listing agent]';
      $('letterAgentPhone').textContent = phoneVal || '[agent phone]';
      $('letterCommissionDisplay').textContent = display || '[commission]';
      $('commissionSuffix').textContent = display ? (' ' + suffix) : '';

      // Signature name (Listed)
      $('signatureName').textContent = nameVal || '[Name]';

      // FSBO bindings
      $('letterNameFSBO').textContent = nameVal || '[name]';
      $('letterAddressFullFSBO').textContent = fullAddr || '[full address]';
      $('letterAddressShort1FSBO').textContent = short || '[short address]';
      $('letterAddressShort2FSBO').textContent = short || '[short address]';
      $('letterAPNFSBO').textContent = apnVal || '[Parcel # / PIN # / Tax ID # / Folio # / APN #]';
      $('fsboPhone').textContent = phoneVal || '[owner/seller phone number]';
      $('fsboEmail').textContent = brokerageVal || '[owner/seller email]';
      $('letterCommissionDisplayFSBO').textContent = display || '[commission]';
      $('commissionSuffixFSBO').textContent = display ? (' ' + suffix) : '';

      // Signature name (FSBO)
      $('signatureNameFSBO').textContent = nameVal || '[Name]';
    }

    // Initial sync to paint placeholders right away
    syncAll();
  });

  /* Submit -> create/verify path with address validation */
  function submitForm(){
    const required = ['name','address','agentPhone'];
    let ok = true;

    for(const id of required){
      const el = $(id);
      if(!el.value.trim()){
        el.classList.add('border-red-500');
        ok = false;
      } else {
        el.classList.remove('border-red-500');
      }
    }
    if(!ok){ alert('Please complete all required fields.'); return; }

    // Validate “full address” format very lightly
    const addr = $('address').value.trim();
    const addrOk = /.+,\s*[A-Za-z ]+,\s*[A-Z]{2}\s*\d{5}$/.test(addr);
    if(!addrOk){
      $('address').classList.add('border-red-500');
      alert('Please use full address format: Street, City, ST 12345');
      return;
    } else {
      $('address').classList.remove('border-red-500');
    }

    // Persist data for downstream pages
    const formData = {
      name: $('name').value.trim(),
      address: addr,
      apn: $('apn').value.trim(),
      commission: $('commission').value.trim(),
      commissionType: $('commissionType').value,
      phone: $('agentPhone').value.trim(),
      brokerage: $('brokerage').value.trim(),
      agent: $('agent').value.trim(),
      agentEmail: $('agentEmail').value.trim() || ''
    };
    localStorage.setItem("formData", JSON.stringify(formData));

    // Precompute short address
    if(formData.address){
      const short = formData.address.split(',')[0];
      localStorage.setItem('shortAddress', short);
    }

    // Post-signature path hint
    const plan = localStorage.getItem('selectedPlan') || 'Listed Property Basic';
    localStorage.setItem('postSignatureOptions', plan.includes('FSBO') ? 'fsbo' : 'listed');

    // Move into auth
    localStorage.setItem('nextAfterLogin', '/verify-code.html');
    window.location.href = "/login.html";
  }
</script>
</body>
</html>
