<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GuaranteedCommission.com</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .font-cursive { font-family: 'Brush Script MT', cursive; }
    .group:hover #commissionMenu, .group:focus-within #commissionMenu { display: block; }
    #commissionMenu { display: none; }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">

<header class="bg-white shadow">
  <div class="flex justify-between items-center max-w-7xl mx-auto px-4 py-4">
    <button onclick="openInvestorModal()" class="bg-red-600 text-white text-xs font-semibold px-3 py-1 rounded">
      Accredited Investors Only
    </button>
    <div class="text-center flex-1">
      <h1 class="text-3xl font-bold">GuaranteedCommission.com</h1>
      <p class="text-sm text-red-600 mt-1 px-2">
        Guaranteeing buyer agent’s commissions so your home will sell quickly at a higher price.
      </p>
    </div>
    <button onclick="openPressModal()" class="bg-blue-600 text-white text-xs font-semibold px-3 py-1 rounded">
      Press Inquiry
    </button>
  </div>
</header>

<!-- Investor Modal -->
<div id="investorModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
  <div class="bg-white rounded-lg shadow-lg p-6 w-96 relative">
    <button onclick="closeInvestorModal()" class="absolute top-2 right-2 text-xl font-bold">&times;</button>
    <h2 class="text-lg font-bold mb-4">Accredited Investor Certification</h2>
    <label class="block mb-2"><input type="checkbox"> Net worth exceeds $1M</label>
    <label class="block mb-2"><input type="checkbox"> Annual income exceeds $200K</label>
    <input type="text" id="investorName" placeholder="Full Name" class="w-full border p-1 mb-2 rounded">
    <input type="tel" id="investorPhone" placeholder="Phone Number" class="w-full border p-1 mb-2 rounded">
    <input type="email" id="investorEmail" placeholder="Email Address" class="w-full border p-1 mb-4 rounded">
    <button onclick="submitInvestorForm()" class="w-full bg-blue-600 text-white py-2 rounded">Submit</button>
    <p id="investorConfirmation" class="mt-4 text-green-600 font-semibold text-center hidden">We will be in touch.</p>
  </div>
</div>

<!-- Press Modal -->
<div id="pressModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
  <div class="bg-white rounded-lg shadow-lg p-6 w-96 relative">
    <button onclick="closePressModal()" class="absolute top-2 right-2 text-xl font-bold">&times;</button>
    <h2 class="text-lg font-bold mb-4">Press Inquiry Form</h2>
    <input type="text" id="pressName" placeholder="Full Name" class="w-full border p-1 mb-2 rounded">
    <input type="text" id="pressOrg" placeholder="Organization" class="w-full border p-1 mb-2 rounded">
    <input type="tel" id="pressPhone" placeholder="Phone Number" class="w-full border p-1 mb-2 rounded">
    <input type="email" id="pressEmail" placeholder="Email Address" class="w-full border p-1 mb-4 rounded">
    <button onclick="submitPressForm()" class="w-full bg-blue-600 text-white py-2 rounded">Submit</button>
    <p id="pressConfirmation" class="mt-4 text-green-600 font-semibold text-center hidden">We will be in touch.</p>
  </div>
</div>

<!-- Nav -->
<nav class="bg-gray-200 py-2">
  <ul class="flex justify-center space-x-8 font-semibold">
    <li class="relative group">
      <span class="hover:underline cursor-pointer">Communicate Guaranteed Commission</span>
      <ul id="commissionMenu" class="absolute left-0 mt-2 w-64 bg-white border shadow text-sm text-gray-700 z-10">
        <li><a href="#" onclick="showForm('listed')" class="block px-4 py-2 hover:bg-gray-100">Listed Property Basic</a></li>
        <li><a href="#" onclick="showForm('plus')" class="block px-4 py-2 hover:bg-gray-100">Listed Property Plus</a></li>
        <li><a href="#" onclick="showForm('fsbo')" class="block px-4 py-2 hover:bg-gray-100">FSBO Plus</a></li>
      </ul>
    </li>
    <li><a href="/search.html" class="hover:underline">Search Guaranteed Commission</a></li>
    <li><a href="/login.html" class="hover:underline">Log In</a></li>
  </ul>
</nav>

<!-- Strip 1 -->
<section class="flex flex-col md:flex-row justify-center items-start gap-6 px-4 py-8 max-w-7xl mx-auto">
  <!-- Box 1 -->
  <div class="w-full md:w-1/3 bg-white p-4 rounded shadow text-sm">
    <h2 class="text-lg font-bold mb-4 text-center">Commission Communication Menu</h2>
    <ul class="space-y-3">
      <li>
        <div onclick="selectPlan('Listed Property Basic')" class="cursor-pointer">
          <p class="text-base font-semibold">Listed Property Basic | <span class="text-red-600">FREE</span></p>
          <p class="text-gray-600 pl-5">Printable commission letter, map search, listing price, main photo, address, square footage, bedrooms, bathrooms, listing brokerage, listing agent, listing agent phone number.</p>
        </div>
      </li>
      <li>
        <div onclick="selectPlan('Listed Property Plus')" class="cursor-pointer">
          <p class="text-base font-semibold">Listed Property Plus | $20</p>
          <p class="text-gray-600 pl-5">Listed Property Basic plus 20 photos and full property description.</p>
        </div>
      </li>
      <li>
        <div onclick="selectPlan('FSBO Plus')" class="cursor-pointer">
          <p class="text-base font-semibold">FSBO Plus | $100</p>
          <p class="text-gray-600 pl-5">Listed Property Plus minus the listing agency. Includes showing instructions.</p>
        </div>
      </li>
    </ul>
  </div>

  <!-- Box 2 -->
  <div id="formBlock" class="w-full md:w-1/3 bg-white p-4 rounded shadow text-sm">
    <h2 id="formTitle" class="text-lg font-bold mb-4 text-center">Listed Property Communication Form</h2>
    <form id="listingForm" class="space-y-2" autocomplete="off">
      <input type="text" id="name" placeholder="Name" class="w-full border p-1 rounded" required>

      <input type="text" id="address" placeholder="Address format: Street, City, ST 12345" class="w-full border p-1 rounded" required>

      <!-- APN row: input + optional mode (Listed/Plus only) -->
      <div id="apnRow">
        <input type="text" id="apn" placeholder="Parcel # / Pin # / Tax ID # / Folio # / APN #" class="w-full border p-1 rounded">
        <div id="apnModeWrap" class="mt-1">
          <label class="text-xs text-gray-600">APN Mode:</label>
          <select id="apnMode" class="ml-2 text-xs border p-1 rounded align-middle">
            <option value="provide" selected>provide now</option>
            <option value="agent">agent to provide</option>
          </select>
        </div>
      </div>

      <!-- Commission -->
      <div class="flex gap-2">
        <input type="text" id="commission" placeholder="Commission" class="w-full border p-1 rounded">
        <select id="commissionType" class="border p-1 rounded">
          <option value="%">%</option>
          <option value="$">$</option>
        </select>
      </div>

      <!-- Phone -->
      <div class="relative">
        <input type="tel" id="agentPhone" placeholder="Agent’s direct phone only – NOT your number" class="w-full border p-1 rounded" required>
        <span id="phoneError" class="text-xs text-red-600 hidden">Please enter a valid phone number (123-456-7890)</span>
      </div>

      <!-- Listed/Plus: Brokerage, Agent, Agent Email -->
      <div id="listedFields">
        <input type="text" id="brokerage" placeholder="Listing Brokerage" class="w-full border p-1 rounded">
        <input type="text" id="agent" placeholder="Listing Agent" class="w-full border p-1 rounded">
        <input type="email" id="agentEmail" placeholder="Listing Agent Email" class="w-full border p-1 rounded">
      </div>

      <!-- FSBO replaces brokerage placeholder with seller email; hides agent + agentEmail -->
      <!-- submit -->
      <button type="button" onclick="submitForm()" class="w-full bg-green-600 text-white py-2 rounded mt-4">
        Submit Guaranteed Commission
      </button>
    </form>
  </div>

  <!-- Box 3 -->
  <div class="w-full md:w-1/3 bg-white p-4 rounded shadow text-sm">
    <h2 class="text-lg font-bold mb-2 text-center">Irrevocable Seller Communication</h2>

    <!-- LISTED ISC -->
    <div id="iscTextListed">
      <p>To the escrow holder/closing agent,</p>
      <p class="mt-2">
        I, <span id="letterName">[name]</span>, am the owner/seller of
        <span id="letterAddressFull">[full address]</span><span id="apnChunkListed">, # <span id="letterAPN">[Parcel # / Pin # / Tax ID # / Folio # / APN #]</span></span>.
        <span id="letterAddressShort1">[short address]</span> is listed for sale by
        <span id="letterBrokerage">[listing brokerage]</span>,
        <span id="letterAgent">[listing agent]</span>, listing agent,
        <span id="letterAgentPhone">[agent phone]</span>.
      </p>
      <p class="mt-2">
        Let it be known: if a buyer’s agent/broker facilitates the sale of
        <span id="letterAddressShort2">[short address]</span>, you (the escrow holder/closing agent)
        are irrevocably instructed to credit/compensate the buyer’s broker – first, by debiting the
        listing brokerage (if there is an agreement for broker-to-broker compensation) and second by
        debiting me, the seller – a commission not to exceed
        <span id="letterCommissionDisplay">[commission]</span>
        <span id="commissionSuffix"></span>.
      </p>
      <p class="mt-4"><span id="signatureName" class="pl-5 font-cursive">[Name]</span> Electronic Signature      date</p>
    </div>

    <!-- FSBO ISC -->
    <div id="iscTextFSBO" class="hidden">
      <p>To the escrow holder/closing agent,</p>
      <p class="mt-2">
        I, <span id="letterNameFSBO">[name]</span>, am the owner/seller of
        <span id="letterAddressFullFSBO">[full address]</span>, #
        <span id="letterAPNFSBO">[Parcel # / Pin # / Tax ID # / Folio # / APN #]</span>.
        <span id="letterAddressShort1FSBO">[short address]</span> is listed for sale by owner (Me).
        My phone number is <span id="fsboPhone"></span>. My email address is <span id="fsboEmail"></span>.
      </p>
      <p class="mt-2">
        Let it be known: if a buyer’s agent/broker facilitates the sale of
        <span id="letterAddressShort2FSBO">[short address]</span>, you (the escrow holder/closing agent)
        are irrevocably instructed to credit/compensate the buyer’s broker a commission not to exceed
        <span id="letterCommissionDisplayFSBO">[commission]</span>
        <span id="commissionSuffixFSBO"></span>.
      </p>
      <p class="mt-4"><span id="signatureNameFSBO" class="pl-5 font-cursive">[Name]</span> Electronic Signature      date</p>
    </div>
  </div>
</section>

<section id="strip2Search" class="max-w-7xl mx-auto px-4 pb-12"></section>

<script>
  /* Header modals */
  function openInvestorModal(){ document.getElementById('investorModal').classList.remove('hidden'); }
  function closeInvestorModal(){ document.getElementById('investorModal').classList.add('hidden'); }
  function submitInvestorForm(){ document.getElementById('investorConfirmation').classList.remove('hidden'); }
  function openPressModal(){ document.getElementById('pressModal').classList.remove('hidden'); }
  function closePressModal(){ document.getElementById('pressModal').classList.add('hidden'); }
  function submitPressForm(){ document.getElementById('pressConfirmation').classList.remove('hidden'); }

  function selectPlan(planName){
    localStorage.setItem("selectedPlan", planName);
    showForm(planName === "FSBO Plus" ? "fsbo" : (planName === "Listed Property Plus" ? "plus" : "listed"));
  }

  function showForm(type){
    const title = document.getElementById("formTitle");
    const apnModeWrap = document.getElementById('apnModeWrap');
    const apnInput = document.getElementById('apn');
    const listedFields = document.getElementById('listedFields');
    const phoneInput = document.getElementById('agentPhone');
    const brokerageInput = document.getElementById('brokerage');
    const agentInput = document.getElementById('agent');
    const agentEmailInput = document.getElementById('agentEmail');

    if(type === 'fsbo'){
      title.textContent = 'FSBO Communication Form';
      // FSBO: APN required, no dropdown
      apnModeWrap.style.display = 'none';
      apnInput.required = true;

      phoneInput.placeholder = 'Owner/Seller phone number';
      brokerageInput.placeholder = 'Owner/Seller email';

      listedFields.style.display = 'none'; // hide brokerage/agent/agentEmail group (but we still use brokerage for owner email)
      document.getElementById('iscTextListed').classList.add('hidden');
      document.getElementById('iscTextFSBO').classList.remove('hidden');
    } else {
      title.textContent = (type === 'plus' ? 'Listed Property Plus Communication Form' : 'Listed Property Communication Form');
      apnModeWrap.style.display = 'block';
      apnInput.required = false;

      phoneInput.placeholder = 'Agent’s direct phone only – NOT your number';
      brokerageInput.placeholder = 'Listing Brokerage';

      listedFields.style.display = 'block';
      document.getElementById('iscTextListed').classList.remove('hidden');
      document.getElementById('iscTextFSBO').classList.add('hidden');
    }
  }

  window.addEventListener('DOMContentLoaded', () => {
    const selectedPlan = localStorage.getItem('selectedPlan') || 'Listed Property Basic';
    if(selectedPlan === 'FSBO Plus') showForm('fsbo');
    else if(selectedPlan === 'Listed Property Plus') showForm('plus');
    else showForm('listed');

    const phoneInput = document.getElementById('agentPhone');
    const phoneError = document.getElementById('phoneError');
    phoneInput.addEventListener('input', function(){
      let v = this.value.replace(/\D/g,'');
      if(v.length>3 && v.length<=6) v = v.replace(/(\d{3})(\d+)/,'$1-$2');
      else if(v.length>6) v = v.replace(/(\d{3})(\d{3})(\d+)/,'$1-$2-$3');
      this.value = v;
      const ok = /^\d{3}-\d{3}-\d{4}$/.test(this.value);
      phoneInput.classList.toggle('border-red-500', !ok);
      phoneError.classList.toggle('hidden', ok);
    });

    ['name','address','apn','brokerage','agent','agentPhone','commission','agentEmail'].forEach(id=>{
      const el = document.getElementById(id);
      if(!el) return;
      el.addEventListener('input', syncAll);
    });
    document.getElementById('commissionType').addEventListener('change', syncAll);
    document.getElementById('apnMode').addEventListener('change', syncAll);

    function syncAll(){
      const fullAddr = (document.getElementById('address').value || '').trim();
      const short = fullAddr.split(',')[0] || '';
      const nameVal = document.getElementById('name').value || '';
      const apnVal = document.getElementById('apn').value || '';
      const apnMode = document.getElementById('apnMode').value;
      const phoneVal = document.getElementById('agentPhone').value || '';
      const brokerageVal = document.getElementById('brokerage').value || '';
      const agentVal = document.getElementById('agent').value || '';

      const amount = (document.getElementById('commission').value || '').trim();
      const type = document.getElementById('commissionType').value;
      const suffix = type === '%' ? 'of the total purchase price' : '';
      const display = type === '$' ? ('$' + amount) : (amount ? amount + '%' : '');

      // Listed
      document.getElementById('letterName').textContent = nameVal || '[name]';
      document.getElementById('letterAddressFull').textContent = fullAddr || '[full address]';
      document.getElementById('letterAddressShort1').textContent = short || '[short address]';
      document.getElementById('letterAddressShort2').textContent = short || '[short address]';
      document.getElementById('letterAPN').textContent = apnVal || '[Parcel # / Pin # / Tax ID # / Folio # / APN #]';
      document.getElementById('letterBrokerage').textContent = brokerageVal || '[listing brokerage]';
      document.getElementById('letterAgent').textContent = agentVal || '[listing agent]';
      document.getElementById('letterAgentPhone').textContent = phoneVal || '[agent phone]';
      document.getElementById('letterCommissionDisplay').textContent = display || '[commission]';
      document.getElementById('commissionSuffix').textContent = display ? (' ' + suffix) : '';

      // APN chunk hide when "agent to provide"
      document.getElementById('apnChunkListed').style.display = (apnMode === 'agent') ? 'none' : 'inline';

      document.getElementById('signatureName').textContent = nameVal || '[Name]';

      // FSBO
      document.getElementById('letterNameFSBO').textContent = nameVal || '[name]';
      document.getElementById('letterAddressFullFSBO').textContent = fullAddr || '[full address]';
      document.getElementById('letterAddressShort1FSBO').textContent = short || '[short address]';
      document.getElementById('letterAddressShort2FSBO').textContent = short || '[short address]';
      document.getElementById('letterAPNFSBO').textContent = apnVal || '[Parcel # / Pin # / Tax ID # / Folio # / APN #]';
      document.getElementById('fsboPhone').textContent = phoneVal || '[owner/seller phone number]';
      document.getElementById('fsboEmail').textContent = brokerageVal || '[owner/seller email]';
      document.getElementById('letterCommissionDisplayFSBO').textContent = display || '[commission]';
      document.getElementById('commissionSuffixFSBO').textContent = display ? (' ' + suffix) : '';
      document.getElementById('signatureNameFSBO').textContent = nameVal || '[Name]';
    }
    syncAll();
  });

  function submitForm(){
    const required = ['name','address','agentPhone'];
    let ok = true;
    for(const id of required){
      const el = document.getElementById(id);
      if(!el.value.trim()){
        el.classList.add('border-red-500');
        ok = false;
      } else {
        el.classList.remove('border-red-500');
      }
    }
    if(!ok){ alert('Please complete all required fields.'); return; }

    // Address pattern (same as placeholder text)
    const addressEl = document.getElementById('address');
    const addressOk = /.+,\s*[^,]+,\s*[A-Z]{2}\s*\d{5}$/.test(addressEl.value.trim());
    if(!addressOk){ alert('Please use full address format: Street, City, ST 12345'); addressEl.focus(); return; }

    const plan = localStorage.getItem('selectedPlan') || 'Listed Property Basic';
    const isFSBO = plan === 'FSBO Plus';

    // FSBO requires APN
    const apn = document.getElementById('apn').value.trim();
    const apnMode = (document.getElementById('apnMode')?.value) || 'provide';
    if(isFSBO && !apn){
      alert('Please enter your Parcel / APN number (required for FSBO).');
      document.getElementById('apn').focus();
      return;
    }

    const formData = {
      name: document.getElementById('name').value.trim(),
      address: addressEl.value.trim(),
      apn,
      apnMode: isFSBO ? 'provide' : apnMode, // fsbo has no dropdown; always provide
      commission: document.getElementById('commission').value.trim(),
      commissionType: document.getElementById('commissionType').value,
      phone: document.getElementById('agentPhone').value.trim(),
      brokerage: document.getElementById('brokerage').value.trim(),
      agent: document.getElementById('agent').value?.trim() || '',
      agentEmail: document.getElementById('agentEmail')?.value?.trim() || ''
    };
    localStorage.setItem("formData", JSON.stringify(formData));

    if(formData.address){
      const short = formData.address.split(',')[0];
      localStorage.setItem('shortAddress', short);
    }

    localStorage.setItem('postSignatureOptions', isFSBO ? 'fsbo' : 'listed');
    localStorage.setItem('nextAfterLogin', '/verify-code.html'); // ensure we go into verification flow
    window.location.href = "/create-account.html";
  }

  function openInvestorModal(){ document.getElementById('investorModal').classList.remove('hidden'); }
  function closeInvestorModal(){ document.getElementById('investorModal').classList.add('hidden'); }
  function submitInvestorForm(){ document.getElementById('investorConfirmation').classList.remove('hidden'); }
  function openPressModal(){ document.getElementById('pressModal').classList.remove('hidden'); }
  function closePressModal(){ document.getElementById('pressModal').classList.add('hidden'); }
  function submitPressForm(){ document.getElementById('pressConfirmation').classList.remove('hidden'); }
</script>
</body>
</html>
