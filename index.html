<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GuaranteedCommission.com</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .font-cursive { font-family: 'Brush Script MT', cursive; }
    /* Nav: reveal submenu on hover or focus; keep click toggle support via .open */
    .group:hover #commissionMenu,
    .group:focus-within #commissionMenu,
    .group.open #commissionMenu { display:block; }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">

<!-- Header -->
<header class="bg-white shadow">
  <div class="flex justify-between items-center max-w-7xl mx-auto px-4 py-4">
    <button onclick="openInvestorModal()" class="bg-red-600 text-white text-xs font-semibold px-3 py-1 rounded">
      Accredited Investors Only
    </button>
    <div class="text-center flex-1">
      <h1 class="text-3xl font-bold">GuaranteedCommission.com</h1>
      <p class="text-sm text-red-600 mt-1 px-2">
        Guaranteeing buyer agent’s commissions so your home will sell quickly at a higher price.
      </p>
    </div>
    <button onclick="openPressModal()" class="bg-blue-600 text-white text-xs font-semibold px-3 py-1 rounded">
      Press Inquiry
    </button>
  </div>
</header>

<!-- Investor Modal -->
<div id="investorModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
  <div class="bg-white rounded-lg shadow-lg p-6 w-96 relative">
    <button onclick="closeInvestorModal()" class="absolute top-2 right-2 text-xl font-bold">&times;</button>
    <h2 class="text-lg font-bold mb-4">Accredited Investor Certification</h2>
    <label class="block mb-2"><input type="checkbox"> Net worth exceeds $1M</label>
    <label class="block mb-2"><input type="checkbox"> Annual income exceeds $200K</label>
    <input type="text" id="investorName" placeholder="Full Name" class="w-full border p-1 mb-2 rounded">
    <input type="tel" id="investorPhone" placeholder="Phone Number" class="w-full border p-1 mb-2 rounded">
    <input type="email" id="investorEmail" placeholder="Email Address" class="w-full border p-1 mb-4 rounded">
    <button onclick="submitInvestorForm()" class="w-full bg-blue-600 text-white py-2 rounded">Submit</button>
    <p id="investorConfirmation" class="mt-4 text-green-600 font-semibold text-center hidden">We will be in touch.</p>
  </div>
</div>

<!-- Press Inquiry Modal -->
<div id="pressModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
  <div class="bg-white rounded-lg shadow-lg p-6 w-96 relative">
    <button onclick="closePressModal()" class="absolute top-2 right-2 text-xl font-bold">&times;</button>
    <h2 class="text-lg font-bold mb-4">Press Inquiry Form</h2>
    <input type="text" id="pressName" placeholder="Full Name" class="w-full border p-1 mb-2 rounded">
    <input type="text" id="pressOrg" placeholder="Organization" class="w-full border p-1 mb-2 rounded">
    <input type="tel" id="pressPhone" placeholder="Phone Number" class="w-full border p-1 mb-2 rounded">
    <input type="email" id="pressEmail" placeholder="Email Address" class="w-full border p-1 mb-4 rounded">
    <button onclick="submitPressForm()" class="w-full bg-blue-600 text-white py-2 rounded">Submit</button>
    <p id="pressConfirmation" class="mt-4 text-green-600 font-semibold text-center hidden">We will be in touch.</p>
  </div>
</div>

<!-- Navigation -->
<nav class="bg-gray-200 py-2">
  <ul class="flex justify-center space-x-8 font-semibold">
    <li class="relative group">
      <button onclick="toggleMenu()" class="hover:underline focus:outline-none cursor-pointer">
        Communicate Guaranteed Commission
      </button>
      <ul id="commissionMenu" class="absolute left-0 mt-2 w-64 bg-white border shadow text-sm text-gray-700 z-10 hidden">
        <li><a href="#" onclick="showForm('listed')" class="block px-4 py-2 hover:bg-gray-100">Listed Property Basic</a></li>
        <li><a href="#" onclick="showForm('plus')" class="block px-4 py-2 hover:bg-gray-100">Listed Property Plus</a></li>
        <li><a href="#" onclick="showForm('fsbo')" class="block px-4 py-2 hover:bg-gray-100">FSBO Plus</a></li>
      </ul>
    </li>
    <li><a href="/search.html" class="hover:underline">Search Guaranteed Commission</a></li>
    <li><a href="/login.html" class="hover:underline">Log In</a></li>
  </ul>
</nav>

<!-- Strip 1 -->
<section class="flex flex-col md:flex-row justify-center items-start gap-6 px-4 py-8 max-w-7xl mx-auto">
  <!-- Box 1 -->
  <div class="w-full md:w-1/3 bg-white p-4 rounded shadow text-sm">
    <h2 class="text-lg font-bold mb-4 text-center">Commission Communication Menu</h2>
    <ul class="space-y-3">
      <li>
        <div onclick="selectPlan('Listed Property Basic')" class="cursor-pointer">
          <p class="text-base font-semibold">Listed Property Basic | <span class="text-red-600">FREE</span></p>
          <p class="text-gray-600 pl-5">Printable commission letter, map search, listing price, main photo, address, square footage, bedrooms, bathrooms, listing brokerage, listing agent, listing agent phone number.</p>
        </div>
      </li>
      <li>
        <div onclick="selectPlan('Listed Property Plus')" class="cursor-pointer">
          <p class="text-base font-semibold">Listed Property Plus | $20</p>
          <p class="text-gray-600 pl-5">Listed Property Basic plus 20 photos and full property description.</p>
        </div>
      </li>
      <li>
        <div onclick="selectPlan('FSBO Plus')" class="cursor-pointer">
          <p class="text-base font-semibold">FSBO Plus | $100</p>
          <p class="text-gray-600 pl-5">Listed Property Plus minus the listing agency. Includes showing instructions.</p>
        </div>
      </li>
    </ul>
  </div>

  <!-- Box 2 -->
  <div id="formBlock" class="w-full md:w-1/3 bg-white p-4 rounded shadow text-sm">
    <h2 class="text-lg font-bold mb-4 text-center">Listed Property Communication Form</h2>
    <form id="listingForm" class="space-y-2" autocomplete="off" novalidate>
      <input type="text" id="name" placeholder="Name" class="w-full border p-1 rounded" required>

      <!-- Full Address Required: street, city, ST, ZIP -->
      <div>
        <input type="text" id="address" placeholder="Full Property Address (Street, City, ST 12345)" class="w-full border p-1 rounded" required>
        <p id="addressHelp" class="text-xs text-gray-500 mt-1">Format example: 123 Main St, Laguna Beach, CA 92651</p>
        <p id="addressError" class="text-xs text-red-600 mt-1 hidden">Please enter a full address with city, 2-letter state, and 5-digit ZIP.</p>
      </div>

      <input type="text" id="apn" placeholder="Parcel # / Pin # / Tax ID # / Folio # / APN #" class="w-full border p-1 rounded">

      <div class="flex gap-2">
        <input type="text" id="commission" placeholder="Commission" class="w-full border p-1 rounded">
        <select id="commissionType" class="border p-1 rounded">
          <option value="%">%</option>
          <option value="$">$</option>
        </select>
      </div>

      <div class="relative">
        <input type="tel" id="agentPhone" placeholder="Agent’s direct phone only – NOT your number" class="w-full border p-1 rounded" required>
        <span id="phoneError" class="text-xs text-red-600 hidden">Please enter a valid phone number (123-456-7890)</span>
      </div>

      <input type="text" id="brokerage" placeholder="Listing Brokerage / (FSBO: enter your email)" class="w-full border p-1 rounded">
      <input type="text" id="agent" placeholder="Listing Agent (hidden for FSBO)" class="w-full border p-1 rounded">

      <button type="button" onclick="submitForm()" class="w-full bg-green-600 text-white py-2 rounded mt-4">
        Submit Listing
      </button>
    </form>
  </div>

  <!-- Box 3 -->
  <div class="w-full md:w-1/3 bg-white p-4 rounded shadow text-sm">
    <h2 class="text-lg font-bold mb-2 text-center">Irrevocable Seller Communication</h2>

    <!-- LISTED ISC -->
    <div id="iscTextListed" class="space-y-4">
      <p>To the escrow holder/closing agent,</p>

      <p>
        I, <span id="letterName">[name]</span>, am the owner/seller of
        <span id="letterAddressFull">[full address]</span>, #
        <span id="letterAPN">[Parcel # / Pin # / Tax ID # / Folio # / APN #]</span>.
        <span id="letterAddressShort1">[short address]</span> is listed for sale by
        <span id="letterBrokerage">[listing brokerage]</span>,
        <span id="letterAgent">[listing agent]</span>, listing agent,
        <span id="letterAgentPhone">[agent phone]</span>.
      </p>

      <p>
        Let it be known: if a buyer’s agent/broker facilitates the sale of
        <span id="letterAddressShort2">[short address]</span>, you (the escrow holder/closing agent)
        are irrevocably instructed to credit/compensate the buyer’s broker – first, by debiting the
        listing brokerage (if there is an agreement for broker-to-broker compensation) and second by
        debiting me, the seller – a commission not to exceed
        <span class="commissionDisplay">[commission]</span><span class="commissionSuffix"></span>.
      </p>

      <p class="mt-2"><span id="signatureName" class="pl-5 font-cursive">[Name]</span> Electronic Signature &nbsp;&nbsp;&nbsp;&nbsp; date</p>
    </div>

    <!-- FSBO ISC -->
    <div id="iscTextFSBO" class="hidden space-y-4">
      <p>To the escrow holder/closing agent,</p>

      <p>
        I, <span id="fsboName">[name]</span>, am the owner/seller of
        <span id="fsboAddressFull">[full address]</span>, #
        <span id="fsboAPN">[Parcel # / Pin # / Tax ID # / Folio # / APN #]</span>.
        <span id="fsboAddressShort1">[short address]</span> is listed for sale by owner (Me).
        My phone number is <span id="fsboPhone"></span>.
        My email address is <span id="fsboEmail"></span>.
      </p>

      <p>
        Let it be known: if a buyer’s agent/broker facilitates the sale of
        <span id="fsboAddressShort2">[short address]</span>, you (the escrow holder/closing agent)
        are irrevocably instructed to credit/compensate the buyer’s broker a commission not to exceed
        <span class="commissionDisplay">[commission]</span><span class="commissionSuffix"></span>.
      </p>

      <p class="mt-2"><span id="signatureNameFSBO" class="pl-5 font-cursive">[Name]</span> Electronic Signature &nbsp;&nbsp;&nbsp;&nbsp; date</p>
    </div>
  </div>
</section>

<!-- Strip 2 Placeholder -->
<section id="strip2Search" class="max-w-7xl mx-auto px-4 py-8">
  <!-- Coming soon -->
</section>

<!-- Scripts -->
<script>
/* ===== Header Modals ===== */
function openInvestorModal(){ document.getElementById('investorModal').classList.remove('hidden'); }
function closeInvestorModal(){ document.getElementById('investorModal').classList.add('hidden'); }
function submitInvestorForm(){ document.getElementById('investorConfirmation').classList.remove('hidden'); }

function openPressModal(){ document.getElementById('pressModal').classList.remove('hidden'); }
function closePressModal(){ document.getElementById('pressModal').classList.add('hidden'); }
function submitPressForm(){ document.getElementById('pressConfirmation').classList.remove('hidden'); }

/* ===== Nav Hover/Click ===== */
function toggleMenu(){
  const group = document.querySelector('.group');
  group.classList.toggle('open');
}

/* ===== Plan Select ===== */
function selectPlan(planName){
  localStorage.setItem("selectedPlan", planName);
  showForm(planName === "FSBO Plus" ? "fsbo" : (planName === "Listed Property Plus" ? "plus" : "listed"));
}

/* ===== Form Switching ===== */
function showForm(type){
  const title = document.querySelector("#formBlock h2");
  const phoneInput = document.getElementById('agentPhone');
  const brokerageInput = document.getElementById('brokerage');
  const agentInput = document.getElementById('agent');

  if (type === 'fsbo') {
    title.textContent = 'FSBO Communication Form';
    phoneInput.placeholder = 'Owner/Seller phone number';
    brokerageInput.placeholder = 'Owner/Seller email';
    agentInput.style.display = 'none';
    document.getElementById('iscTextListed').classList.add('hidden');
    document.getElementById('iscTextFSBO').classList.remove('hidden');
  } else {
    title.textContent = (type === 'plus') ? 'Listed Property Plus Communication Form' : 'Listed Property Communication Form';
    phoneInput.placeholder = 'Agent’s direct phone only – NOT your number';
    brokerageInput.placeholder = 'Listing Brokerage';
    agentInput.style.display = 'block';
    document.getElementById('iscTextListed').classList.remove('hidden');
    document.getElementById('iscTextFSBO').classList.add('hidden');
  }
}

/* ===== Helpers: validation & formatting ===== */

// Accepts formats like: "123 Main St, Laguna Beach, CA 92651"
function looksLikeFullUSAddress(addr){
  // Require a comma before city, 2-letter state, and 5-digit zip
  // Street can be anything non-empty before first comma
  const re = /^\s*.+?,\s*[A-Za-z .'-]+,\s*[A-Z]{2}\s+\d{5}\s*$/;
  return re.test(addr);
}

// Phone mask + validity
function formatPhoneDash(val){
  let digits = val.replace(/\D/g,'').slice(0,10);
  if (digits.length > 6) return digits.replace(/(\d{3})(\d{3})(\d{1,4})/, '$1-$2-$3');
  if (digits.length > 3) return digits.replace(/(\d{3})(\d{1,3})/, '$1-$2');
  return digits;
}

/* ===== Shared commission updater (applies to Listed & FSBO) ===== */
function updateCommissionUI(){
  const amount = document.getElementById('commission').value.trim();
  const type = document.getElementById('commissionType').value;
  const suffix = (type === '%') ? ' of the total purchase price' : '';
  const display = amount ? (type === '$' ? ('$' + amount) : (amount + '%')) : '[commission]';

  document.querySelectorAll('.commissionDisplay').forEach(el => el.textContent = display);
  document.querySelectorAll('.commissionSuffix').forEach(el => el.textContent = suffix);
}

/* ===== DOM Ready ===== */
window.addEventListener('DOMContentLoaded', () => {
  // Default to Listed
  const selectedPlan = localStorage.getItem('selectedPlan') || 'Listed Property Basic';
  if (selectedPlan === 'FSBO Plus') showForm('fsbo');
  else if (selectedPlan === 'Listed Property Plus') showForm('plus');
  else showForm('listed');

  // Phone input mask + validation
  const phoneInput = document.getElementById('agentPhone');
  const phoneError = document.getElementById('phoneError');
  phoneInput.addEventListener('input', function(){
    this.value = formatPhoneDash(this.value);
    const ok = /^\d{3}-\d{3}-\d{4}$/.test(this.value);
    phoneInput.classList.toggle('border-red-500', !ok && this.value.length>0);
    phoneError.classList.toggle('hidden', ok || this.value.length===0);
  });

  // Address validation on blur & on submit (friendly message)
  const addr = document.getElementById('address');
  const addrErr = document.getElementById('addressError');
  addr.addEventListener('blur', () => {
    const valid = looksLikeFullUSAddress(addr.value);
    addr.classList.toggle('border-red-500', !valid);
    addrErr.classList.toggle('hidden', valid);
  });

  // Live mirror into ISC (Listed + FSBO)
  ['name','address','apn','brokerage','agent','agentPhone'].forEach(id => {
    const el = document.getElementById(id);
    el.addEventListener('input', () => {
      const nameVal = document.getElementById('name').value;
      const fullAddr = document.getElementById('address').value;
      const short = fullAddr.split(',')[0] || '';

      // Listed fields
      document.getElementById('letterName').textContent = nameVal || '[name]';
      document.getElementById('letterAddressFull').textContent = fullAddr || '[full address]';
      document.getElementById('letterAddressShort1').textContent = short || '[short address]';
      document.getElementById('letterAddressShort2').textContent = short || '[short address]';
      document.getElementById('letterAPN').textContent = document.getElementById('apn').value || '[Parcel # / Pin # / Tax ID # / Folio # / APN #]';
      document.getElementById('letterBrokerage').textContent = document.getElementById('brokerage').value || '[listing brokerage]';
      document.getElementById('letterAgent').textContent = document.getElementById('agent').value || '[listing agent]';
      document.getElementById('letterAgentPhone').textContent = document.getElementById('agentPhone').value || '[agent phone]';

      // FSBO fields (separate IDs so both blocks stay correct)
      document.getElementById('fsboName').textContent = nameVal || '[name]';
      document.getElementById('fsboAddressFull').textContent = fullAddr || '[full address]';
      document.getElementById('fsboAddressShort1').textContent = short || '[short address]';
      document.getElementById('fsboAddressShort2').textContent = short || '[short address]';
      document.getElementById('fsboAPN').textContent = document.getElementById('apn').value || '[Parcel # / Pin # / Tax ID # / Folio # / APN #]';

      // FSBO phone/email live fill
      const isFSBO = document.querySelector("#formBlock h2").textContent.includes("FSBO");
      if (isFSBO) {
        document.getElementById('fsboPhone').textContent = document.getElementById('agentPhone').value || '[owner/seller phone]';
        document.getElementById('fsboEmail').textContent = document.getElementById('brokerage').value || '[owner/seller email]';
      }

      // Signature names (both)
      document.getElementById('signatureName').textContent = nameVal || '[Name]';
      document.getElementById('signatureNameFSBO').textContent = nameVal || '[Name]';
    });
  });

  // Commission display sync (Listed + FSBO)
  document.getElementById('commission').addEventListener('input', updateCommissionUI);
  document.getElementById('commissionType').addEventListener('change', updateCommissionUI);
  updateCommissionUI(); // initialize
});

/* ===== Submit: validate and advance ===== */
function submitForm(){
  // Validate required fields
  const required = ['name','address','agentPhone'];
  let valid = true;

  // Address must be full address
  const addressInput = document.getElementById('address');
  const addressValid = looksLikeFullUSAddress(addressInput.value);
  if (!addressValid){
    valid = false;
    addressInput.classList.add('border-red-500');
    document.getElementById('addressError').classList.remove('hidden');
  }

  required.forEach(id => {
    const el = document.getElementById(id);
    if (!el.value.trim()){
      el.classList.add('border-red-500');
      valid = false;
    } else {
      el.classList.remove('border-red-500');
    }
  });

  // Phone format
  const phoneOK = /^\d{3}-\d{3}-\d{4}$/.test(document.getElementById('agentPhone').value);
  if (!phoneOK){ valid = false; document.getElementById('phoneError').classList.remove('hidden'); }

  if (!valid){
    alert("Please complete all required fields with valid formats.");
    return;
  }

  const formData = {
    name: document.getElementById('name').value.trim(),
    address: document.getElementById('address').value.trim(),
    apn: document.getElementById('apn').value.trim(),
    commission: document.getElementById('commission').value.trim(),
    commissionType: document.getElementById('commissionType').value,
    agentPhone: document.getElementById('agentPhone').value.trim(),
    brokerage: document.getElementById('brokerage').value.trim(),
    agent: document.getElementById('agent').value.trim()
  };
  localStorage.setItem("formData", JSON.stringify(formData));

  // Default next step
  window.location.href = "/create-account.html";
}
</script>
</body>
</html>
